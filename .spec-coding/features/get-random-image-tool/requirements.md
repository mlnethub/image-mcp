# 需求规格说明书 - get-random-image-tool

## 1. 概述
本功能针对现有的 `get_random_image` MCP 工具进行增强，使其在调用 Unsplash 随机图片接口时具备更完善的参数支持与稳健性，帮助调用方获取符合主题、数量与方向需求的视觉素材。

## 2. 需求列表

### REQ-001 核心调用
- 用户故事：作为一名 MCP 客户端用户或 AI 助手，我想要调用改进后的 `get_random_image` 获取随机图片，以便在需要灵感或替换背景时快速得到合适的素材。
- 验收标准：
	1. 当工具 `get_random_image` 被调用时，系统应向 Unsplash `/photos/random` 端点发起 GET 请求，并记录失败原因以便排查（例如日志或异常信息）。
	2. 当请求被构建时，系统应使用 `ImageApiOptions` 中的 `BaseUrl` 和 `ClientId` 进行 URL 拼接与认证，并保持与现有配置兼容。

### REQ-002 参数处理
- 用户故事：作为调用方，我想要通过关键词、数量和方向参数控制返回的图片，以便获得符合上下文需求的结果集。
- 验收标准：
	1. 当调用包含 `query` 时，系统应将其去除首尾空白后 URL 编码，并作为 `query` 参数传递给 Unsplash。
	2. 当调用包含 `count` 时，系统应将其作为 `count` 参数传递；当未提供时，系统应默认传递 `count=1`，并在代码中将其约束在 1 到 5 的范围内（超出范围时应用最接近的边界值）。
	3. 当调用包含 `orientation` 且值为 `landscape`、`portrait` 或 `squarish`（不区分大小写）时，系统应将其标准化后作为 `orientation` 参数传递；当未提供时，系统应使用 `orientation=landscape`。

### REQ-003 响应映射
- 用户故事：作为调用方，我想要得到结构化的图片信息，以便后续处理或展示。
- 验收标准：
	1. 当 Unsplash 返回成功响应时，系统应将 JSON 解析为 `IEnumerable<ImageResult>`，无论响应根节点是数组还是单个对象。
	2. 当解析单条或多条记录时，系统应确保 `ImageResult` 的 `Urls`、`Description`、`AltDescription` 字段从响应中正确映射；当字段缺失时，系统应提供安全的默认值（例如 null 或空字符串）。

### REQ-004 异常与稳健性
- 用户故事：作为调用方，我想要工具在网络或 API 异常时表现稳定，以便上层应用可以优雅地处理失败场景。
- 验收标准：
	1. 当请求失败、响应无法解析或返回空内容时，系统应记录错误并返回一个空的 `IEnumerable<ImageResult>` 而非抛出未捕获异常。
	2. 当 API 响应格式非预期（如返回对象而非数组）或 `count` 超出 API 限制时，系统应处理该情况并返回已解析的结果集合或空集合。
